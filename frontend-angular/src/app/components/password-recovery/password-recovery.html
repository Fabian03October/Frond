<div class="recovery-container">
  <div class="recovery-card">
    <div class="recovery-header">
      <h1>🔐 Recuperar Contraseña</h1>
      <p>{{ step === 'email' ? 'Ingresa tu email para recibir un código' : 
           step === 'code' ? 'Verifica el código enviado a tu email' : 
           'Establece tu nueva contraseña' }}</p>
    </div>
    
    <!-- Paso 1: Solicitar código por email -->
    <form *ngIf="step === 'email'" (ngSubmit)="sendRecoveryCode()" class="recovery-form">
      <div class="form-group">
        <label for="email">Email:</label>
        <input 
          type="email" 
          id="email" 
          [(ngModel)]="email" 
          name="email"
          placeholder="tu@email.com"
          required>
      </div>
      
      <div *ngIf="error" class="error-message">
        {{ error }}
      </div>
      
      <button type="submit" [disabled]="loading" class="recovery-btn">
        {{ loading ? 'Enviando...' : 'Enviar Código' }}
      </button>
    </form>

    <!-- Paso 2: Verificar código -->
    <form *ngIf="step === 'code'" (ngSubmit)="verifyCode()" class="recovery-form">
      <div class="success-message">
        ✅ Código enviado a: {{ email }}
      </div>
      
      <div class="form-group">
        <label for="verificationCode">Código de verificación:</label>
        <input 
          type="text" 
          id="verificationCode" 
          [(ngModel)]="verificationCode" 
          name="verificationCode"
          placeholder="Ingresa el código de 6 dígitos"
          required>
      </div>
      
      <div *ngIf="error" class="error-message">
        {{ error }}
      </div>
      
      <button type="submit" [disabled]="loading" class="recovery-btn">
        {{ loading ? 'Verificando...' : 'Verificar Código' }}
      </button>

      <div class="resend-section">
        <button type="button" (click)="resendCode()" class="link-btn">
          ¿No recibiste el código? Reenviar
        </button>
      </div>
    </form>

    <!-- Paso 3: Nueva contraseña -->
    <form *ngIf="step === 'newPassword'" (ngSubmit)="resetPassword()" class="recovery-form">
      <div class="form-group">
        <label for="newPassword">Nueva contraseña:</label>
        <div class="password-input-container">
          <input 
            [type]="showNewPassword ? 'text' : 'password'" 
            id="newPassword" 
            [(ngModel)]="newPassword" 
            name="newPassword"
            placeholder="Mínimo 8 caracteres"
            required>
          <button 
            type="button" 
            class="password-toggle-btn"
            (click)="toggleNewPasswordVisibility()">
            {{ showNewPassword ? '🙈' : '👁️' }}
          </button>
        </div>
      </div>

      <div class="form-group">
        <label for="confirmNewPassword">Confirmar nueva contraseña:</label>
        <div class="password-input-container">
          <input 
            [type]="showConfirmNewPassword ? 'text' : 'password'" 
            id="confirmNewPassword" 
            [(ngModel)]="confirmNewPassword" 
            name="confirmNewPassword"
            placeholder="Repite la nueva contraseña"
            required>
          <button 
            type="button" 
            class="password-toggle-btn"
            (click)="toggleConfirmNewPasswordVisibility()">
            {{ showConfirmNewPassword ? '🙈' : '👁️' }}
          </button>
        </div>
      </div>
      
      <div *ngIf="error" class="error-message">
        {{ error }}
      </div>
      
      <button type="submit" [disabled]="loading" class="recovery-btn">
        {{ loading ? 'Actualizando...' : 'Restablecer Contraseña' }}
      </button>
    </form>
    
    <div class="recovery-footer">
      <button type="button" (click)="goToLogin()" class="link-btn">
        ← Volver al inicio de sesión
      </button>
    </div>
  </div>
</div>
